
# 多环境设置

在日常开发工作中，一般都会使用多个环境，比如测试环境和正式环境。Qross 管理系统支持多环境设置，可以根据开发需求配置多个环境。

配置多个环境主要有两个目的：

1. 方便不同的环境之间同步内容，比如在测试环境进行开发，开发完成后将开发的内容同步（发布）到正式环境。这个功能要求至少数据库能够连通。
2. 一套系统管理多个环境，并且能在多个环境之间自由切换。这个功能要求不同环境之间网络能够互通或者本来就是在同一网络内。

如果没有以上两个需求，或者不能做到不同环境的网络连接或者数据库连通，则没有配置多环境的必要，在不同的网络分别部署 Qross 系统即可。

配置多个环境的注意事项：

1. 如果要实现数据同步功能，需要通过 Qross 管理系统配置多环境，主要是数据连接配置。如果两个环境均启动了 Qross 系统，那么只在一个环境配置多环境即可。
2. 每个环境都需配置 Qross 数据库，即使在同一个数据库实例上，也需要不同的数据库名。
3. 如果要实现环境切换功能，要求两个环境的网络能够互通且最好在一个局域网内，这时多环境只需要启用一个 Qross 管理系统即可。
4. 不同环境使用同一套用户信息系统，但可以在不同的环境中设置不同的角色和权限。注意一定在配置多环境的 Qross 管理系统中管理用户，这样才能正确同步用户数据。
5. 切换环境的功能默认关闭，当多个环境在同一局域网内时，才可能启用此功能。在管理系统页面的左上，可以找到切换环境的下拉菜单。
6. 切换环境的权限默认开启，可以为每个角色或用户单独配置。
7. 同步数据的权限管理员角色默认开启，其他角色默认关闭，可以为每个角色或用户单独配置。可以分别设置不同环境之间的同步权限。

多环境相关的设置项主要有两个：

1. 当前环境名称。可按照业务需求命名，比如测试环境、生产环境等。
2. 是否启用多环境切换。当配置的多个环境在同一网络内时，可以启用此功能。

连接其他环境的配置主要有：

1. 环境名称。
2. Qross 数据库连接串（MySQL）。
3. 其他环境是否可以与这个环境同步数据。

多环境切换功能要求网络互通的原因主要是调度功能。不同的环境要配置不同的 Keeper 调度工具，比如测试环境只需要配置单机 Keeper，而生产环境则要启用 Keeper 集群。而且不建议将 Keeper 的 restful 服务暴露在外网中。