# Keeper 参数设置

Keeper 参数影响所有 Keeper 节点，建议在启动 Keeper 之前设置，如果在 Keeper 运行中设置，有的参数需要重启 Keeper。

各环境参数的说明如下：

* 单 CPU 任务并行度，可以理解为每个 CPU 内核可以同时运行多少个程序命令或脚本。在负载不高的服务器上或单机场景下，可以把倍数设置的高一些，在多机场景下，可以把倍数调低一些。一般建议位数为`4`或`8`。如果 CPU 为`4`核，任务并行数设置为`8`，那么可同时运行的命令为`32`。修改后需要重启 Keeper。

* 心跳事件触发频率。 Keeper 每分钟心跳一次，同时可触发 Keeper 全局事件`onNodeBeat`。如果每分钟都触发一次，那么这个事件就执行得过于频繁了。这里可以设置一个用 Cron 表达式表示的“频率”，在指定的时间或周期内触发心跳事件。心跳事件一般用于对 Keeper 节点健康程序的检查，如定时发邮件给管理员，告诉管理员 Keeper 在正常运行。可设置为空，表示不触发心跳事件。修改为无需要重启 Keeper。

* Keeper 接口服务地址。Keeper 提供了一些 Restful 接口用于对 Keeper 或任务进行操控，如立即运行任务、重启任务等。这个设置主要为 Master 管理工具服务，如果两个程序都运行在同一台机器上，可设置为`localhost`。如果不在同一台机器上，可指定为任意一台运行 Keeper 机器的 IP 地址。在单机场景下，设定为这台机器的 IP 即可。在 PQL 中对应的全局变量为`@KEEPER_HTTP_ADDRESS`。修改后无需要重启 Keeper。

* Keeper 服务端口。像其他程序一样，Keeper 也会占用机器的一个端口用于向其他程序提供服务，默认端口是`7700`。如果这个端口已经被其他程序占用，可以修改为其他端口。在 Keeper 启动之后，可在浏览器输入相应的地址和端口对 Keeper 进行连通性测试，如`http://localhost:7700`。如果看到`Welcome to Qross Keeper!`，则表示 Keeper 已经正常启动。在 PQL 中对应的全局变量为`@KEEPER_HTTP_PORT`。端口修改后需要重启 Keeper。

* Keeper 运行记录的保存时间。Keeper 在运行过程中会产生日志和相应的运行记录，这些记录会占用磁盘和数据库空间。在生产环境没有严格要求的情况下，建议保留一定时间的日志和记录即可，如`100`天。超过这个时间的日志将会被清理掉以释放空间。修改后无需要重启 Keeper。

---
参考链接

* [Keeper 多机模式](/keeper/cluster.md)
* [Keeper 节点管理](/master/keeper/nodes.md)
* [Qross 系统安装](/qross/install.md)


