# 用户函数 FUNCTION 语句

在开发过程中，有时需要定义一个可重复调用的语句块，以减少代码量且可以让代码逻辑清晰。这个语句块可以使用 PQL 用户函数来定义，使用 FUNCTION 语句进行函数声明。

## 定义用户函数

用户函数分为函数名、函数参数和函数体三部分，一个简单的示例如下：

```sql
FUNCTION $func_name ($a, $b DEFAULT 'hello')
     BEGIN
           -- statements …
           RETURN $a + $b;
     END;
```

* `$func_name`是函数名。和用户变量一样，用户函数名必须以`$`开头，由英文字母、数字和下划线构成，建议全部小写。
* 函数的作用域仅是当前 PQL 过程，可以在当前过程的任何地方定义。
* `$a`和`$b`是函数的参数。函数参数声明也必须以`$`开头，作用域仅为当前函数内。
* 函数参数可以使用`DEFAULT`关键词赋默认值。
* 所有函数参数使用小括号括起来。
* 可以不声明任何参数，但也要输入一个空括号。
* 不需要声明函数的返回值。
* 函数体以`BEGIN`关键字开始，并以`END`关键字结束。
* `END`关键字后面的分号不能省略，表示 FUNCTION 语句的结束。
* 在函数中使用`RETURN`语句返回结果，可以是 PQL 支持的数据类型。参见 [RETURN 语句](/pql/return.md)。
* RETURN 语句仅在函数体内使用，RETURN 语句返回函数的结果并中断函数的执行。
* 函数可以没有 RETURN 语句，就是可以没有返回值。没有 RETURN 语句的函数返回`NULL`。
* 函数可以嵌套函数，如`$x(2, $p(3, 4))`。

## 定义系统函数

如果想定义作用于所有 PQL 过程的函数，需要定义系统函数，更多信息请参照[系统函数](/pql/global-function.md)。

## 调用函数

关于如何调用已定义的函数，请参阅 [CALL 语句](/pql/call.md)。

---
参考链接
* [函数调用 CALL](/pql/call.md)
* [中断数据并返回值 RETURN](/pql/return.md)
* [系统函数 FUNCTION](/pql/global-function.md)