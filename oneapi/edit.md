# 创建和编辑接口

主要介绍一下基于文件管理的接口格式，数据库管理的接口待页面开发完成之后补全。

### 保存在文件中的接口创建和编辑

每一个接口都由接口头和接口内容两部分组成，接口头保存接口的设置信息，接口内容即接口的逻辑，由 **PQL** 编写。如下示例：
```sql
## test | GET | score=60 |
SELECT * FROM table1 where score>=#{score};

## test | PUT | score=60&id=0 | monitor,teacher |
UPDATE table1 SET score=#{score} WHERE id=#{id};
INSERT INTO table2 (student_id, score) VALUES (#{id}, #{score});

## test | POST | monitor |
INSERT INTO table1 (name, score) VALUES ('#{'name'}', #{score});

## test | DELETE | teacher
DELETE FROM table1 WHERE id=#{id}
``` 
上例中声明了4个接口，接口头的设置都有所不同。现在将关键点分别说明一下：

* 接口头单独一行，必须以`##`开始。
* 接口头最多包含四部分，按顺序分别为 **接口名称**，**接口请求方法**，**接口参数默认值** 和 **接口访问控制**。除接口名称和接口请求方法外，另两项可省略。
  + 以上`test`为接口名称，接口名称一般为一个单词，如果是多个单词，单词之间使用中横线`-`隔开，接口名称全部小写，可以包含数字。接口名是接口地址路径中的最后一部分。
  + `GET`、`PUT`、`POST`和`DELETE`为接口请求方法。在一个项目中，接口可以重名，但“接口名+请求方法”须唯一，出现重复后面定义的接口会覆盖前面的。可以设置多个请求方法，使用逗号`,`隔开。
  + 接口默认值的格式与地址请求字符串相同，格式为`name=Tom&age=18&score=89`。如果用户请求接口时未传递某个参数，则使用默认值代替。
  + 接口访问控制的请求者名称，多个请求者之间使用逗号`,`隔开，即允许哪些请求者访问这个接口。一定注意这里控制的是 **请求方法Method+接口名称**。这里一般填写用户名或角色名，多个用户名或角色名之间使用逗号`,`分隔，表示这些用户或角色可以访问这个接口。可以对接口访问进行批量控制，请参阅[访问控制](/oneapi/permit.md)，
  + 接口头各项之间使用竖线`|`分隔，最后一项后面可以省略竖线。
* 接口内容另起一行，除接口头以外的都算接口内容，由PQL编写，语法需遵循PQL规则。当然，不了解PQL也可以写接口。以上4个示例接口均未涉及到PQL语法规则。
  + 上例内容中的`#{id}`、`#{score}`和`#{'name'}`为接口参数，详细内容请参阅[向OenApi传递参数](/oneapi/params.md)。
  + 接口内容可以写多条语句，会按顺序依次执行。每条语句必须以分号`;`结束。语句之间可以空行。最后一条语句的分号可省略。请参阅[PQL基础](/pql/basic.md)
* 接口与接口之间建议空一行以方便阅读。

### 数据库管理的接口创建和编辑

文档待完善。

---
参考链接

* [PQL过程化查询语言](/pql/overview.md)
* [向PQL过程传递参数](/pql/params.md)
* [OneApi访问控制](/oneapi/token.md)
* [OneApi全局设置](/oneapi/setup.md)